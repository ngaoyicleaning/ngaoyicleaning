<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ngaoyi Cleaning - Working Demo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Include jsPDF for invoice generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Your existing CSS - keep it all the same */
        :root {
            --primary: #2E8B57;
            --primary-dark: #1F6B45;
            --secondary: #FF6B35;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --dark: #2c3e50;
            --light: #f8f9fa;
            --gray: #6c757d;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 30px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .company-info h1 {
            font-size: 2.5em;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .company-info p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .current-time {
            background: rgba(255,255,255,0.2);
            padding: 12px 25px;
            border-radius: 30px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }
        
        .tabs {
            display: flex;
            background: var(--light);
            border-bottom: 2px solid #e9ecef;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 18px 35px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .tab.active {
            border-bottom-color: var(--primary);
            background: white;
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
            padding: 40px;
            min-height: 600px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1em;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(46, 139, 87, 0.1);
            transform: translateY(-2px);
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(46, 139, 87, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #218838);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #e0a800);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #c82333);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border-left: 5px solid var(--primary);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .stat-number {
            font-size: 2.8em;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 1.1em;
            font-weight: 500;
        }
        
        .dashboard-section {
            background: var(--light);
            padding: 30px;
            border-radius: 16px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 1.8em;
            color: var(--dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .rating-stars {
            color: #FFD700;
            font-size: 1.2em;
        }
        
        .cleaner-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }
        
        .cleaner-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.12);
        }
        
        .cleaner-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .cleaner-name {
            font-size: 1.4em;
            font-weight: 600;
            color: var(--dark);
        }
        
        .cleaner-rating {
            background: var(--primary);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .cleaner-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            color: var(--gray);
        }
        
        .admin-panel {
            background: var(--light);
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .login-form {
            max-width: 450px;
            margin: 80px auto;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .status-message {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .checklist-section {
            margin: 25px 0;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .section-header {
            background: #f8f9fa;
            padding: 15px 20px;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .checklist-items {
            padding: 20px;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .checklist-item:last-child {
            border-bottom: none;
        }
        
        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            accent-color: var(--primary);
        }
        
        .progress-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
        }
        
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .connection-test {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            border-left: 4px solid var(--primary);
        }
        
        .connection-status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
        }
        
        .connection-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .connection-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                min-width: 100%;
            }
            
            .header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .date-filter {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
        }

        .welcome-banner {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
        }

        /* NEW STYLES FOR ADMIN DASHBOARD */
        .admin-tabs {
            display: flex;
            background: var(--light);
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .admin-tab {
            padding: 12px 25px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            text-align: center;
            font-weight: 600;
        }
        
        .admin-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }
        
        .badge-info {
            background: #cce7ff;
            color: #004085;
        }
        
        .invoice-preview {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin: 20px 0;
            border: 1px solid #e9ecef;
        }
        
        .invoice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary);
        }
        
        .invoice-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .invoice-items {
            margin: 30px 0;
        }
        
        .invoice-totals {
            margin-top: 30px;
            text-align: right;
        }
        
        .invoice-total-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .invoice-total-row:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.2em;
            color: var(--primary);
        }
        
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin: 20px 0;
            height: 300px;
        }
        
        .payment-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .payment-status-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-top: 5px solid var(--primary);
        }
        
        .payment-status-card.paid {
            border-top-color: var(--success);
        }
        
        .payment-status-card.pending {
            border-top-color: var(--warning);
        }
        
        .payment-status-card.overdue {
            border-top-color: var(--danger);
        }
        
        .payment-amount {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .cleaner-payment-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .payment-actions {
            display: flex;
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <img src="https://raw.githubusercontent.com/ngaoyicleaning/ngaoyicleaning/main/assets/logo.png" 
                     alt="Ngaoyi Cleaning" class="logo">
                <div class="company-info">
                    <h1>Ngaoyi Cleaning</h1>
                    <p>Professional Cleaning Management System</p>
                </div>
            </div>
            <div class="current-time" id="currentTime">
                <i class="fas fa-clock"></i> Loading...
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="cleaner">
                <i class="fas fa-broom"></i> Cleaner Portal
            </div>
            <div class="tab" data-tab="admin">
                <i class="fas fa-cogs"></i> Admin Portal
            </div>
        </div>
        
        <!-- Cleaner Portal Tab -->
        <div class="tab-content active" id="cleaner-tab">
            <h2 class="section-title">
                <i class="fas fa-broom"></i> Cleaner Portal
            </h2>
            
            <div class="admin-panel">
                <div class="input-group">
                    <label for="cleanerNumber">
                        <i class="fas fa-id-card"></i> Your Cleaner Number *
                    </label>
                    <input type="text" id="cleanerNumber" placeholder="NCC0001" value="NCC0001">
                    <small>Try: NCC0001, NCC0002, or NCC0003</small>
                </div>
                
                <button class="btn" onclick="loadCleanerJobs()">
                    <i class="fas fa-sync-alt"></i> Load My Assignments
                </button>
            </div>

            <!-- Date Filter Section -->
            <div id="dateFilterSection" class="date-filter" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-filter"></i> Filter Jobs by Date
                </h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <button class="btn btn-secondary" onclick="filterJobs('today')">
                        <i class="fas fa-calendar-day"></i> Today's Jobs
                    </button>
                    <button class="btn btn-secondary" onclick="filterJobs('upcoming')">
                        <i class="fas fa-calendar-week"></i> Upcoming Jobs
                    </button>
                    <button class="btn btn-secondary" onclick="filterJobs('all')">
                        <i class="fas fa-calendar-alt"></i> All Jobs
                    </button>
                </div>
                <div style="margin-top: 15px; text-align: center;">
                    <small id="currentFilter">Showing: All Jobs</small>
                </div>
            </div>
            
            <div id="cleanerJobs" style="display: none;">
                <!-- Welcome Banner with Cleaner Name -->
                <div id="welcomeBanner" class="welcome-banner" style="display: none;">
                    <h3 id="welcomeMessage"></h3>
                    <p id="cleanerScheduleInfo"></p>
                </div>
                
                <div class="dashboard-section">
                    <h3 class="section-title">
                        <i class="fas fa-calendar-check"></i> Your Schedule
                    </h3>
                    <div id="jobsSummary"></div>
                </div>
                
                <div id="jobsList">
                    <!-- Jobs will be loaded here -->
                </div>
            </div>
            
            <div id="checklistSection" style="display: none;">
                <!-- Checklist will be loaded here -->
            </div>
            
            <div id="cleanerStatusMessage" class="status-message"></div>
        </div>
        
        <!-- Admin Portal Tab -->
        <div class="tab-content" id="admin-tab">
            <div id="adminLoginSection">
                <div class="login-form">
                    <img src="https://raw.githubusercontent.com/ngaoyicleaning/ngaoyicleaning/main/assets/logo.png" 
                         alt="Ngaoyi Cleaning" style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 20px;">
                    <h2>Admin Authentication</h2>
                    
                    <div class="input-group">
                        <label for="adminUsername">
                            <i class="fas fa-user"></i> Username
                        </label>
                        <input type="text" id="adminUsername" placeholder="Enter admin username" value="admin1">
                    </div>
                    
                    <div class="input-group">
                        <label for="adminPassword">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password" value="admin1">
                    </div>
                    
                    <button class="btn" onclick="adminLogin()">
                        <i class="fas fa-sign-in-alt"></i> Login to Admin Portal
                    </button>
                    
                    <div id="adminLoginMessage" class="status-message" style="display: none; margin-top: 20px;"></div>
                </div>
            </div>
            
            <div id="adminPanel" style="display: none;">
                <h2 class="section-title">
                    <i class="fas fa-cogs"></i> Admin Management Portal
                </h2>
                <p>Welcome, <span id="adminUserName"></span>!</p>
                
                <!-- Admin Tabs -->
                <div class="admin-tabs">
                    <div class="admin-tab active" data-admin-tab="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </div>
                    <div class="admin-tab" data-admin-tab="ratings">
                        <i class="fas fa-star"></i> Ratings & Reviews
                    </div>
                    <div class="admin-tab" data-admin-tab="invoices">
                        <i class="fas fa-file-invoice"></i> Invoices
                    </div>
                    <div class="admin-tab" data-admin-tab="sales">
                        <i class="fas fa-chart-line"></i> Sales Dashboard
                    </div>
                    <div class="admin-tab" data-admin-tab="payments">
                        <i class="fas fa-money-bill-wave"></i> Payments
                    </div>
                </div>
                
                <!-- Admin Dashboard Tab -->
                <div class="admin-tab-content active" id="admin-dashboard">
                    <div class="admin-panel">
                        <h3 class="section-title">
                            <i class="fas fa-info-circle"></i> System Status
                        </h3>
                        <p>âœ… Backend connection successful</p>
                        <p>ðŸ”„ Using demo data for testing</p>
                        <p>ðŸ“Š All features available locally</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="stat-number" id="totalJobs">0</div>
                            <div class="stat-label">Total Jobs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-users"></i></div>
                            <div class="stat-number" id="totalCleaners">0</div>
                            <div class="stat-label">Active Cleaners</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-star"></i></div>
                            <div class="stat-number" id="avgRating">0.0</div>
                            <div class="stat-label">Average Rating</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                            <div class="stat-number" id="totalRevenue">R0</div>
                            <div class="stat-label">Total Revenue</div>
                        </div>
                    </div>
                    
                    <div class="admin-panel">
                        <h3 class="section-title">
                            <i class="fas fa-users"></i> Test Cleaners Available
                        </h3>
                        <div class="cleaner-card">
                            <div class="cleaner-header">
                                <div class="cleaner-name">Sarah Johnson</div>
                                <div class="cleaner-rating">NCC0001</div>
                            </div>
                            <div class="cleaner-details">
                                <div><strong>Phone:</strong> 0721234567</div>
                                <div><strong>Status:</strong> Active</div>
                                <div><strong>Today's Jobs:</strong> 1</div>
                            </div>
                        </div>
                        <div class="cleaner-card">
                            <div class="cleaner-header">
                                <div class="cleaner-name">Mike Chang</div>
                                <div class="cleaner-rating">NCC0002</div>
                            </div>
                            <div class="cleaner-details">
                                <div><strong>Phone:</strong> 0839876543</div>
                                <div><strong>Status:</strong> Active</div>
                                <div><strong>Tomorrow's Jobs:</strong> 1</div>
                            </div>
                        </div>
                        <div class="cleaner-card">
                            <div class="cleaner-header">
                                <div class="cleaner-name">Anna Mbele</div>
                                <div class="cleaner-rating">NCC0003</div>
                            </div>
                            <div class="cleaner-details">
                                <div><strong>Phone:</strong> 0715551234</div>
                                <div><strong>Status:</strong> Active</div>
                                <div><strong>Next Jobs:</strong> Day after tomorrow</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ratings & Reviews Tab -->
                <div class="admin-tab-content" id="admin-ratings">
                    <h3 class="section-title">
                        <i class="fas fa-star"></i> Customer Ratings & Reviews
                    </h3>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-star"></i></div>
                            <div class="stat-number">4.7</div>
                            <div class="stat-label">Overall Rating</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-comments"></i></div>
                            <div class="stat-number">42</div>
                            <div class="stat-label">Total Reviews</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-thumbs-up"></i></div>
                            <div class="stat-number">89%</div>
                            <div class="stat-label">Positive Feedback</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                            <div class="stat-number">96%</div>
                            <div class="stat-label">Would Recommend</div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Customer</th>
                                    <th>Cleaner</th>
                                    <th>Rating</th>
                                    <th>Review</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="ratingsTableBody">
                                <!-- Ratings will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Invoices Tab -->
                <div class="admin-tab-content" id="admin-invoices">
                    <h3 class="section-title">
                        <i class="fas fa-file-invoice"></i> Invoice Management
                    </h3>
                    
                    <div class="admin-panel">
                        <h4>Generate New Invoice</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div class="input-group">
                                <label for="invoiceCustomer">Customer</label>
                                <select id="invoiceCustomer">
                                    <option value="">Select Customer</option>
                                    <!-- Options will be populated -->
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="invoiceJob">Job</label>
                                <select id="invoiceJob">
                                    <option value="">Select Job</option>
                                    <!-- Options will be populated -->
                                </select>
                            </div>
                        </div>
                        <button class="btn" onclick="generateInvoicePreview()">
                            <i class="fas fa-eye"></i> Preview Invoice
                        </button>
                    </div>
                    
                    <div id="invoicePreviewSection" style="display: none;">
                        <h4 class="section-title">Invoice Preview</h4>
                        <div id="invoicePreview" class="invoice-preview">
                            <!-- Invoice preview will be generated here -->
                        </div>
                        <button class="btn btn-success" onclick="downloadInvoiceAsPDF()">
                            <i class="fas fa-download"></i> Download as PDF
                        </button>
                        <button class="btn btn-secondary" onclick="sendInvoiceToCustomer()">
                            <i class="fas fa-paper-plane"></i> Send to Customer
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <h4 class="section-title">Recent Invoices</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Invoice #</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="invoicesTableBody">
                                <!-- Invoices will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Sales Dashboard Tab -->
                <div class="admin-tab-content" id="admin-sales">
                    <h3 class="section-title">
                        <i class="fas fa-chart-line"></i> Sales Dashboard
                    </h3>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                            <div class="stat-number" id="grossProfit">R0</div>
                            <div class="stat-label">Gross Profit</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="stat-number" id="jobsThisMonth">0</div>
                            <div class="stat-label">Jobs This Month</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-trend-up"></i></div>
                            <div class="stat-number" id="growthRate">0%</div>
                            <div class="stat-label">Growth Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                            <div class="stat-number" id="repeatCustomers">0%</div>
                            <div class="stat-label">Repeat Customers</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h4>Revenue Trend (Last 6 Months)</h4>
                        <canvas id="revenueChart"></canvas>
                    </div>
                    
                    <div class="table-container">
                        <h4 class="section-title">All Jobs/Sales History</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Job ID</th>
                                    <th>Customer</th>
                                    <th>Service</th>
                                    <th>Cleaner</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="salesHistoryTableBody">
                                <!-- Sales history will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Payments Tab -->
                <div class="admin-tab-content" id="admin-payments">
                    <h3 class="section-title">
                        <i class="fas fa-money-bill-wave"></i> Payment Management
                    </h3>
                    
                    <div class="payment-status-grid">
                        <div class="payment-status-card paid">
                            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="payment-amount" id="paidAmount">R0</div>
                            <div class="stat-label">Paid</div>
                        </div>
                        <div class="payment-status-card pending">
                            <div class="stat-icon"><i class="fas fa-clock"></i></div>
                            <div class="payment-amount" id="pendingAmount">R0</div>
                            <div class="stat-label">Pending</div>
                        </div>
                        <div class="payment-status-card overdue">
                            <div class="stat-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <div class="payment-amount" id="overdueAmount">R0</div>
                            <div class="stat-label">Overdue</div>
                        </div>
                    </div>
                    
                    <div class="admin-panel">
                        <h4 class="section-title">Cleaner Payments</h4>
                        <div id="cleanerPaymentsList">
                            <!-- Cleaner payments will be populated here -->
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <h4 class="section-title">Payment History</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Payment ID</th>
                                    <th>Customer</th>
                                    <th>Invoice #</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Method</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTableBody">
                                <!-- Payments will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ENHANCED DEMO DATA - Includes cleaner names and multiple date jobs
        const demoData = {
            cleaners: {
                'NCC0001': {
                    name: 'Sarah Johnson',
                    phone: '0721234567',
                    jobs: [
                        {
                            CleanerNumber: 'NCC0001',
                            CustomerNumber: 'CUST0001',
                            ServiceType: '2-bed-standard',
                            ScheduleDate: new Date().toISOString().split('T')[0], // Today
                            Status: 'Scheduled',
                            Priority: 'High',
                            customerName: 'John Smith',
                            customerAddress: '123 Main Street, Johannesburg',
                            customerPhone: '0831112222',
                            SpecialInstructions: 'Focus on kitchen, pet in house'
                        },
                        {
                            CleanerNumber: 'NCC0001',
                            CustomerNumber: 'CUST0002', 
                            ServiceType: '3-bed-premium',
                            ScheduleDate: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // Day after tomorrow
                            Status: 'Scheduled',
                            Priority: 'Standard',
                            customerName: 'Robert Wilson',
                            customerAddress: '789 Luxury Lane, Sandton',
                            customerPhone: '0824445555',
                            SpecialInstructions: 'Premium service requested'
                        }
                    ]
                },
                'NCC0002': {
                    name: 'Mike Chang',
                    phone: '0839876543',
                    jobs: [
                        {
                            CleanerNumber: 'NCC0002',
                            CustomerNumber: 'CUST0003',
                            ServiceType: '1-bed-standard',
                            ScheduleDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0], // Tomorrow
                            Status: 'Scheduled',
                            Priority: 'Standard',
                            customerName: 'Emma Brown',
                            customerAddress: '456 Oak Avenue, Sandton',
                            customerPhone: '0723334444',
                            SpecialInstructions: 'Eco-friendly products only'
                        },
                        {
                            CleanerNumber: 'NCC0002',
                            CustomerNumber: 'CUST0004',
                            ServiceType: '2-bed-deep',
                            ScheduleDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // In 3 days
                            Status: 'Scheduled',
                            Priority: 'High',
                            customerName: 'Lisa Davis',
                            customerAddress: '321 Elm Street, Rosebank',
                            customerPhone: '0716667777',
                            SpecialInstructions: 'Move-out deep clean'
                        }
                    ]
                },
                'NCC0003': {
                    name: 'Anna Mbele',
                    phone: '0715551234',
                    jobs: [
                        {
                            CleanerNumber: 'NCC0003',
                            CustomerNumber: 'CUST0005',
                            ServiceType: '3-bed-standard',
                            ScheduleDate: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // Day after tomorrow
                            Status: 'Scheduled',
                            Priority: 'Standard',
                            customerName: 'David Thompson',
                            customerAddress: '654 Maple Avenue, Parktown',
                            customerPhone: '0838889999',
                            SpecialInstructions: 'Focus on bathrooms'
                        }
                    ]
                }
            },
            // NEW: Admin dashboard data
            adminData: {
                totalJobs: 42,
                totalCleaners: 3,
                avgRating: 4.7,
                totalRevenue: 12560,
                ratings: [
                    {
                        customer: 'John Smith',
                        cleaner: 'Sarah Johnson',
                        rating: 5,
                        review: 'Excellent service, very thorough!',
                        date: '2023-10-15'
                    },
                    {
                        customer: 'Emma Brown',
                        cleaner: 'Mike Chang',
                        rating: 4,
                        review: 'Good job, arrived on time.',
                        date: '2023-10-12'
                    },
                    {
                        customer: 'Robert Wilson',
                        cleaner: 'Sarah Johnson',
                        rating: 5,
                        review: 'Outstanding attention to detail.',
                        date: '2023-10-10'
                    },
                    {
                        customer: 'Lisa Davis',
                        cleaner: 'Anna Mbele',
                        rating: 4,
                        review: 'Very professional, would hire again.',
                        date: '2023-10-08'
                    }
                ],
                invoices: [
                    {
                        id: 'INV-001',
                        customer: 'John Smith',
                        amount: 450,
                        date: '2023-10-15',
                        status: 'Paid'
                    },
                    {
                        id: 'INV-002',
                        customer: 'Emma Brown',
                        amount: 350,
                        date: '2023-10-12',
                        status: 'Pending'
                    },
                    {
                        id: 'INV-003',
                        customer: 'Robert Wilson',
                        amount: 600,
                        date: '2023-10-10',
                        status: 'Paid'
                    },
                    {
                        id: 'INV-004',
                        customer: 'Lisa Davis',
                        amount: 550,
                        date: '2023-10-08',
                        status: 'Overdue'
                    }
                ],
                salesHistory: [
                    {
                        jobId: 'JOB-001',
                        customer: 'John Smith',
                        service: '2-bed-standard',
                        cleaner: 'Sarah Johnson',
                        date: '2023-10-15',
                        amount: 450,
                        status: 'Completed'
                    },
                    {
                        jobId: 'JOB-002',
                        customer: 'Emma Brown',
                        service: '1-bed-standard',
                        cleaner: 'Mike Chang',
                        date: '2023-10-12',
                        amount: 350,
                        status: 'Completed'
                    },
                    {
                        jobId: 'JOB-003',
                        customer: 'Robert Wilson',
                        service: '3-bed-premium',
                        cleaner: 'Sarah Johnson',
                        date: '2023-10-10',
                        amount: 600,
                        status: 'Completed'
                    },
                    {
                        jobId: 'JOB-004',
                        customer: 'Lisa Davis',
                        service: '2-bed-deep',
                        cleaner: 'Anna Mbele',
                        date: '2023-10-08',
                        amount: 550,
                        status: 'Completed'
                    }
                ],
                payments: [
                    {
                        id: 'PAY-001',
                        customer: 'John Smith',
                        invoice: 'INV-001',
                        amount: 450,
                        date: '2023-10-15',
                        method: 'Credit Card',
                        status: 'Paid'
                    },
                    {
                        id: 'PAY-002',
                        customer: 'Robert Wilson',
                        invoice: 'INV-003',
                        amount: 600,
                        date: '2023-10-10',
                        method: 'Bank Transfer',
                        status: 'Paid'
                    }
                ],
                cleanerPayments: [
                    {
                        cleaner: 'Sarah Johnson',
                        amount: 320,
                        jobs: 2,
                        status: 'Pending'
                    },
                    {
                        cleaner: 'Mike Chang',
                        amount: 250,
                        jobs: 2,
                        status: 'Pending'
                    },
                    {
                        cleaner: 'Anna Mbele',
                        amount: 275,
                        jobs: 1,
                        status: 'Pending'
                    }
                ]
            }
        };

        let currentCleanerData = null;
        let currentFilter = 'all';

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            initializeTabs();
            initializeAdminTabs();
        });

        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            document.getElementById('currentTime').innerHTML = `<i class="fas fa-clock"></i> ${timeString}`;
        }

        function initializeTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.tab;
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(`${tabName}-tab`).classList.add('active');
                });
            });
        }

        function initializeAdminTabs() {
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.adminTab;
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.admin-tab-content').forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(`admin-${tabName}`).classList.add('active');
                });
            });
        }

        // Cleaner Portal Functions
        function loadCleanerJobs() {
            const cleanerNumber = document.getElementById('cleanerNumber').value.trim().toUpperCase();
            
            if (!cleanerNumber) {
                showCleanerStatus('Please enter your cleaner number', 'error');
                return;
            }

            if (!demoData.cleaners[cleanerNumber]) {
                showCleanerStatus(`Cleaner ${cleanerNumber} not found. Try NCC0001, NCC0002, or NCC0003`, 'error');
                return;
            }

            showCleanerStatus('Loading your assignments...', 'success');

            // Store current cleaner data
            currentCleanerData = demoData.cleaners[cleanerNumber];
            
            setTimeout(() => {
                displayCleanerWelcome(cleanerNumber);
                displayCleanerJobs(currentCleanerData.jobs);
                document.getElementById('cleanerJobs').style.display = 'block';
                document.getElementById('dateFilterSection').style.display = 'block';
                showCleanerStatus(`Welcome ${currentCleanerData.name}! Found ${currentCleanerData.jobs.length} assignments`, 'success');
            }, 1000);
        }

        function displayCleanerWelcome(cleanerNumber) {
            const cleaner = demoData.cleaners[cleanerNumber];
            const today = new Date().toISOString().split('T')[0];
            const todayJobs = cleaner.jobs.filter(job => job.ScheduleDate === today);
            
            document.getElementById('welcomeBanner').style.display = 'block';
            document.getElementById('welcomeMessage').textContent = `Welcome, ${cleaner.name}!`;
            document.getElementById('cleanerScheduleInfo').textContent = 
                `You have ${todayJobs.length} job(s) today and ${cleaner.jobs.length} total assignments.`;
        }

        function displayCleanerJobs(jobs) {
            const jobsList = document.getElementById('jobsList');
            const jobsSummary = document.getElementById('jobsSummary');
            
            const today = new Date().toISOString().split('T')[0];
            const filteredJobs = filterJobsByDate(jobs, currentFilter);
            const todayJobs = jobs.filter(job => job.ScheduleDate === today);
            const upcomingJobs = jobs.filter(job => job.ScheduleDate > today);
            
            jobsSummary.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-calendar-day"></i></div>
                        <div class="stat-number">${todayJobs.length}</div>
                        <div class="stat-label">Today's Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-calendar-week"></i></div>
                        <div class="stat-number">${upcomingJobs.length}</div>
                        <div class="stat-label">Upcoming Jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                        <div class="stat-number">${jobs.length}</div>
                        <div class="stat-label">Total Assignments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-eye"></i></div>
                        <div class="stat-number">${filteredJobs.length}</div>
                        <div class="stat-label">Currently Showing</div>
                    </div>
                </div>
            `;

            if (filteredJobs.length === 0) {
                jobsList.innerHTML = `
                    <div class="cleaner-card">
                        <div class="cleaner-header">
                            <div class="cleaner-name">No Jobs Found</div>
                        </div>
                        <div class="cleaner-details">
                            <div>No assignments match your current filter.</div>
                            <div>Try changing the date filter or check back later.</div>
                        </div>
                    </div>
                `;
                return;
            }

            jobsList.innerHTML = filteredJobs.map(job => `
                <div class="cleaner-card fade-in">
                    <div class="cleaner-header">
                        <div class="cleaner-name">${getServiceDisplayName(job.ServiceType)}</div>
                        <div class="cleaner-rating" style="background: ${getPriorityColor(job.Priority)}">
                            ${job.Priority || 'Standard'}
                        </div>
                    </div>
                    <div class="cleaner-details">
                        <div><strong>Customer:</strong> ${job.customerName}</div>
                        <div><strong>Date:</strong> ${formatDate(job.ScheduleDate)}</div>
                        <div><strong>Time:</strong> ${getScheduleTime(job.ScheduleDate)}</div>
                        <div><strong>Phone:</strong> ${job.customerPhone}</div>
                        <div><strong>Address:</strong> ${job.customerAddress}</div>
                        <div><strong>Status:</strong> <span style="color: ${getStatusColor(job.Status)}">${job.Status}</span></div>
                    </div>
                    ${job.SpecialInstructions ? `<div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <strong>Instructions:</strong> ${job.SpecialInstructions}
                    </div>` : ''}
                    <button class="btn ${job.ScheduleDate === today ? 'btn-success' : 'btn-secondary'}" 
                            onclick="loadChecklist('${job.CleanerNumber}', '${job.CustomerNumber}', '${job.ServiceType}')"
                            style="margin-top: 15px;">
                        <i class="fas fa-clipboard-check"></i> 
                        ${job.ScheduleDate === new Date().toISOString().split('T')[0] ? 'Start Checklist' : 'View Details'}
                    </button>
                </div>
            `).join('');
        }

        function filterJobs(filterType) {
            currentFilter = filterType;
            document.getElementById('currentFilter').textContent = `Showing: ${getFilterDisplayName(filterType)}`;
            
            if (currentCleanerData && currentCleanerData.jobs) {
                const filteredJobs = filterJobsByDate(currentCleanerData.jobs, filterType);
                displayCleanerJobs(currentCleanerData.jobs); // This will use the filtered jobs
            }
        }

        function filterJobsByDate(jobs, filterType) {
            const today = new Date().toISOString().split('T')[0];
            
            switch(filterType) {
                case 'today':
                    return jobs.filter(job => job.ScheduleDate === today);
                case 'upcoming':
                    return jobs.filter(job => job.ScheduleDate > today);
                case 'all':
                default:
                    return jobs;
            }
        }

        function getFilterDisplayName(filterType) {
            const names = {
                'today': "Today's Jobs",
                'upcoming': "Upcoming Jobs", 
                'all': "All Jobs"
            };
            return names[filterType] || 'All Jobs';
        }

        function getScheduleTime(dateString) {
            // Simple time assignment based on date
            const date = new Date(dateString);
            const today = new Date().toISOString().split('T')[0];
            
            if (dateString === today) return '09:00 AM';
            if (dateString > today) return 'Morning';
            return 'Scheduled';
        }

        function getStatusColor(status) {
            const colors = {
                'Scheduled': '#17a2b8',
                'In Progress': '#ffc107',
                'Completed': '#28a745',
                'Cancelled': '#dc3545'
            };
            return colors[status] || '#6c757d';
        }

        function getPriorityColor(priority) {
            const colors = {
                'High': '#dc3545',
                'Medium': '#ffc107',
                'Low': '#17a2b8',
                'Standard': '#6c757d'
            };
            return colors[priority] || '#6c757d';
        }

        function loadChecklist(cleanerNumber, customerNumber, serviceType) {
            const checklistHTML = generateChecklistHTML(serviceType);
            document.getElementById('checklistSection').innerHTML = checklistHTML;
            document.getElementById('checklistSection').style.display = 'block';
            document.getElementById('checklistSection').scrollIntoView({ behavior: 'smooth' });
            showCleanerStatus('Checklist loaded. Start completing tasks!', 'success');
        }

        function generateChecklistHTML(serviceType) {
            return `
                <div class="job-info">
                    <h3>ðŸ§¹ Cleaning Checklist - ${getServiceDisplayName(serviceType)}</h3>
                    <p>Complete all tasks and submit when finished</p>
                </div>

                <div class="checklist-section">
                    <div class="section-header">
                        <span>ðŸš½ Bathroom Cleaning</span>
                        <span class="section-progress">0/6 tasks</span>
                    </div>
                    <div class="checklist-items">
                        ${createChecklistItem('Clean toilet inside and out with disinfectant')}
                        ${createChecklistItem('Disinfect sink, faucet, and countertops')}
                        ${createChecklistItem('Clean mirror and glass surfaces')}
                        ${createChecklistItem('Scrub shower/bathtub and rinse thoroughly')}
                        ${createChecklistItem('Empty trash bin and replace liner')}
                        ${createChecklistItem('Mop floor and dry properly')}
                    </div>
                </div>

                <div class="checklist-section">
                    <div class="section-header">
                        <span>ðŸ³ Kitchen Cleaning</span>
                        <span class="section-progress">0/5 tasks</span>
                    </div>
                    <div class="checklist-items">
                        ${createChecklistItem('Clean and disinfect all countertops')}
                        ${createChecklistItem('Scrub sink and polish faucet')}
                        ${createChecklistItem('Wipe exterior of all appliances')}
                        ${createChecklistItem('Empty trash bin and replace liner')}
                        ${createChecklistItem('Mop floor and dry thoroughly')}
                    </div>
                </div>

                <div class="progress-section">
                    <h4>Overall Progress</h4>
                    <div class="progress-text">Completion: <span id="checklistProgress">0%</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="checklistProgressBar"></div>
                    </div>
                    <div>Tasks Completed: <span id="completedTasksCount">0</span> / <span id="totalTasksCount">15</span></div>
                </div>

                <div class="input-group">
                    <label for="customerRating">â­ Customer Rating (1-5 stars)</label>
                    <select id="customerRating">
                        <option value="5">5 Stars - Excellent</option>
                        <option value="4">4 Stars - Very Good</option>
                        <option value="3">3 Stars - Good</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="cleanerNotes">ðŸ“ Notes & Comments</label>
                    <textarea id="cleanerNotes" placeholder="Any issues or additional comments..."></textarea>
                </div>

                <button class="btn btn-success" onclick="submitChecklist()" id="submitChecklistBtn">
                    Submit Completed Checklist
                </button>

                <button class="btn btn-secondary" onclick="cancelChecklist()" style="margin-left: 10px;">
                    Cancel
                </button>
            `;
        }

        function createChecklistItem(text) {
            const id = 'check_' + Math.random().toString(36).substr(2, 9);
            return `
                <div class="checklist-item">
                    <input type="checkbox" id="${id}" class="task-checkbox" onchange="updateChecklistProgress()">
                    <label for="${id}">${text}</label>
                </div>
            `;
        }

        function updateChecklistProgress() {
            const checkboxes = document.querySelectorAll('.task-checkbox');
            const checked = document.querySelectorAll('.task-checkbox:checked').length;
            const total = checkboxes.length;
            const progress = total > 0 ? (checked / total) * 100 : 0;
            
            document.getElementById('checklistProgressBar').style.width = `${progress}%`;
            document.getElementById('checklistProgress').textContent = `${Math.round(progress)}%`;
            document.getElementById('completedTasksCount').textContent = checked;
            document.getElementById('totalTasksCount').textContent = total;
        }

        function submitChecklist() {
            showCleanerStatus('âœ… Checklist submitted successfully! (Demo Mode)', 'success');
            setTimeout(() => {
                document.getElementById('checklistSection').style.display = 'none';
            }, 3000);
        }

        function cancelChecklist() {
            document.getElementById('checklistSection').style.display = 'none';
            showCleanerStatus('Checklist cancelled', 'success');
        }

        // Admin Functions
        function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;

            if (username === 'admin1' && password === 'admin1') {
                document.getElementById('adminLoginSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('adminUserName').textContent = username;
                
                // Load admin dashboard data
                loadAdminDashboard();
            } else {
                showAdminLoginMessage('Invalid credentials. Use admin1/admin1', 'error');
            }
        }

        function loadAdminDashboard() {
            // Update dashboard stats
            document.getElementById('totalJobs').textContent = demoData.adminData.totalJobs;
            document.getElementById('totalCleaners').textContent = demoData.adminData.totalCleaners;
            document.getElementById('avgRating').textContent = demoData.adminData.avgRating;
            document.getElementById('totalRevenue').textContent = `R${demoData.adminData.totalRevenue}`;
            
            // Load ratings table
            const ratingsTableBody = document.getElementById('ratingsTableBody');
            ratingsTableBody.innerHTML = demoData.adminData.ratings.map(rating => `
                <tr>
                    <td>${rating.customer}</td>
                    <td>${rating.cleaner}</td>
                    <td>
                        <span class="rating-stars">
                            ${'â˜…'.repeat(rating.rating)}${'â˜†'.repeat(5 - rating.rating)}
                        </span>
                        (${rating.rating}/5)
                    </td>
                    <td>${rating.review}</td>
                    <td>${formatDate(rating.date)}</td>
                </tr>
            `).join('');
            
            // Load invoices table
            const invoicesTableBody = document.getElementById('invoicesTableBody');
            invoicesTableBody.innerHTML = demoData.adminData.invoices.map(invoice => `
                <tr>
                    <td>${invoice.id}</td>
                    <td>${invoice.customer}</td>
                    <td>R${invoice.amount}</td>
                    <td>${formatDate(invoice.date)}</td>
                    <td><span class="badge badge-${getInvoiceStatusClass(invoice.status)}">${invoice.status}</span></td>
                    <td>
                        <button class="btn btn-secondary" onclick="viewInvoice('${invoice.id}')">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn" onclick="downloadInvoice('${invoice.id}')">
                            <i class="fas fa-download"></i> PDF
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Load sales history table
            const salesHistoryTableBody = document.getElementById('salesHistoryTableBody');
            salesHistoryTableBody.innerHTML = demoData.adminData.salesHistory.map(sale => `
                <tr>
                    <td>${sale.jobId}</td>
                    <td>${sale.customer}</td>
                    <td>${getServiceDisplayName(sale.service)}</td>
                    <td>${sale.cleaner}</td>
                    <td>${formatDate(sale.date)}</td>
                    <td>R${sale.amount}</td>
                    <td><span class="badge badge-success">${sale.status}</span></td>
                </tr>
            `).join('');
            
            // Load payments table
            const paymentsTableBody = document.getElementById('paymentsTableBody');
            paymentsTableBody.innerHTML = demoData.adminData.payments.map(payment => `
                <tr>
                    <td>${payment.id}</td>
                    <td>${payment.customer}</td>
                    <td>${payment.invoice}</td>
                    <td>R${payment.amount}</td>
                    <td>${formatDate(payment.date)}</td>
                    <td>${payment.method}</td>
                    <td><span class="badge badge-success">${payment.status}</span></td>
                </tr>
            `).join('');
            
            // Load cleaner payments
            const cleanerPaymentsList = document.getElementById('cleanerPaymentsList');
            cleanerPaymentsList.innerHTML = demoData.adminData.cleanerPayments.map(payment => `
                <div class="cleaner-payment-card">
                    <div>
                        <h4>${payment.cleaner}</h4>
                        <p>Amount: R${payment.amount} | Jobs: ${payment.jobs}</p>
                    </div>
                    <div class="payment-actions">
                        <span class="badge badge-warning">${payment.status}</span>
                        <button class="btn btn-success" onclick="markCleanerPaid('${payment.cleaner}')">
                            <i class="fas fa-check"></i> Mark Paid
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Update payment status cards
            const paidAmount = demoData.adminData.invoices
                .filter(inv => inv.status === 'Paid')
                .reduce((sum, inv) => sum + inv.amount, 0);
            const pendingAmount = demoData.adminData.invoices
                .filter(inv => inv.status === 'Pending')
                .reduce((sum, inv) => sum + inv.amount, 0);
            const overdueAmount = demoData.adminData.invoices
                .filter(inv => inv.status === 'Overdue')
                .reduce((sum, inv) => sum + inv.amount, 0);
                
            document.getElementById('paidAmount').textContent = `R${paidAmount}`;
            document.getElementById('pendingAmount').textContent = `R${pendingAmount}`;
            document.getElementById('overdueAmount').textContent = `R${overdueAmount}`;
            
            // Update sales dashboard stats
            document.getElementById('grossProfit').textContent = `R${demoData.adminData.totalRevenue}`;
            document.getElementById('jobsThisMonth').textContent = demoData.adminData.salesHistory.length;
            document.getElementById('growthRate').textContent = '12%';
            document.getElementById('repeatCustomers').textContent = '35%';
            
            // Populate customer dropdown for invoice generation
            const customerSelect = document.getElementById('invoiceCustomer');
            customerSelect.innerHTML = '<option value="">Select Customer</option>' + 
                demoData.adminData.salesHistory.map(sale => 
                    `<option value="${sale.customer}">${sale.customer}</option>`
                ).join('');
        }

        function getInvoiceStatusClass(status) {
            const classes = {
                'Paid': 'success',
                'Pending': 'warning',
                'Overdue': 'danger'
            };
            return classes[status] || 'info';
        }

        function generateInvoicePreview() {
            const customer = document.getElementById('invoiceCustomer').value;
            const job = document.getElementById('invoiceJob').value;
            
            if (!customer) {
                alert('Please select a customer');
                return;
            }
            
            // Find customer details
            const customerDetails = demoData.adminData.salesHistory.find(s => s.customer === customer);
            if (!customerDetails) {
                alert('Customer details not found');
                return;
            }
            
            // Generate invoice number
            const invoiceNumber = 'INV-' + (demoData.adminData.invoices.length + 1).toString().padStart(3, '0');
            const invoiceDate = new Date().toISOString().split('T')[0];
            const dueDate = new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            // Calculate amounts
            const subtotal = customerDetails.amount;
            const tax = subtotal * 0.15; // 15% VAT
            const total = subtotal + tax;
            
            // Generate invoice preview HTML
            document.getElementById('invoicePreview').innerHTML = `
                <div class="invoice-header">
                    <div>
                        <h2>Ngaoyi Cleaning</h2>
                        <p>123 Business Street<br>Johannesburg, 2000<br>Phone: 011 123 4567</p>
                    </div>
                    <div style="text-align: right;">
                        <h2>INVOICE</h2>
                        <p><strong>Invoice #:</strong> ${invoiceNumber}</p>
                        <p><strong>Date:</strong> ${formatDate(invoiceDate)}</p>
                        <p><strong>Due Date:</strong> ${formatDate(dueDate)}</p>
                    </div>
                </div>
                
                <div class="invoice-details">
                    <div>
                        <h3>Bill To:</h3>
                        <p>${customerDetails.customer}<br>
                        ${getCustomerAddress(customerDetails.customer)}<br>
                        Phone: ${getCustomerPhone(customerDetails.customer)}</p>
                    </div>
                    <div>
                        <h3>Service Details:</h3>
                        <p><strong>Job ID:</strong> ${customerDetails.jobId}</p>
                        <p><strong>Service:</strong> ${getServiceDisplayName(customerDetails.service)}</p>
                        <p><strong>Cleaner:</strong> ${customerDetails.cleaner}</p>
                        <p><strong>Date:</strong> ${formatDate(customerDetails.date)}</p>
                    </div>
                </div>
                
                <div class="invoice-items">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 12px; text-align: left;">Description</th>
                                <th style="padding: 12px; text-align: right;">Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #e9ecef;">
                                    ${getServiceDisplayName(customerDetails.service)} Cleaning Service
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid #e9ecef; text-align: right;">
                                    R${subtotal.toFixed(2)}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #e9ecef;">VAT (15%)</td>
                                <td style="padding: 12px; border-bottom: 1px solid #e9ecef; text-align: right;">
                                    R${tax.toFixed(2)}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="invoice-totals">
                    <div class="invoice-total-row">
                        <span>Subtotal:</span>
                        <span>R${subtotal.toFixed(2)}</span>
                    </div>
                    <div class="invoice-total-row">
                        <span>Tax:</span>
                        <span>R${tax.toFixed(2)}</span>
                    </div>
                    <div class="invoice-total-row">
                        <span>Total:</span>
                        <span>R${total.toFixed(2)}</span>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
                    <p><strong>Payment Instructions:</strong></p>
                    <p>Please make payment within 14 days. Bank details: Ngaoyi Cleaning, Bank: Standard Bank, Account: 123456789, Branch: 12345</p>
                </div>
            `;
            
            document.getElementById('invoicePreviewSection').style.display = 'block';
        }

        function downloadInvoiceAsPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Get the invoice preview element
            const invoiceElement = document.getElementById('invoicePreview');
            
            // Use html2canvas to capture the invoice as an image
            html2canvas(invoiceElement).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                
                let position = 0;
                
                // Add first page
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Add additional pages if needed
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Save the PDF
                doc.save('invoice.pdf');
            });
        }

        function sendInvoiceToCustomer() {
            alert('Invoice sent to customer (Demo Mode)');
        }

        function markCleanerPaid(cleanerName) {
            alert(`Payment marked as paid for ${cleanerName} (Demo Mode)`);
        }

        function viewInvoice(invoiceId) {
            alert(`Viewing invoice ${invoiceId} (Demo Mode)`);
        }

        function downloadInvoice(invoiceId) {
            alert(`Downloading invoice ${invoiceId} as PDF (Demo Mode)`);
        }

        function getCustomerAddress(customerName) {
            // In a real app, this would fetch from a database
            const addresses = {
                'John Smith': '123 Main Street, Johannesburg',
                'Emma Brown': '456 Oak Avenue, Sandton',
                'Robert Wilson': '789 Luxury Lane, Sandton',
                'Lisa Davis': '321 Elm Street, Rosebank',
                'David Thompson': '654 Maple Avenue, Parktown'
            };
            return addresses[customerName] || 'Address not available';
        }

        function getCustomerPhone(customerName) {
            // In a real app, this would fetch from a database
            const phones = {
                'John Smith': '0831112222',
                'Emma Brown': '0723334444',
                'Robert Wilson': '0824445555',
                'Lisa Davis': '0716667777',
                'David Thompson': '0838889999'
            };
            return phones[customerName] || 'Phone not available';
        }

        function showAdminLoginMessage(message, type) {
            const statusEl = document.getElementById('adminLoginMessage');
            statusEl.innerHTML = message;
            statusEl.className = `status-message status-${type} fade-in`;
            statusEl.style.display = 'block';
        }

        // Utility Functions
        function getServiceDisplayName(serviceType) {
            const names = {
                '1-bed-standard': '1-Bedroom Standard Clean',
                '2-bed-standard': '2-Bedroom Standard Clean', 
                '3-bed-standard': '3-Bedroom Standard Clean',
                '3-bed-premium': '3-Bedroom Premium Clean',
                '1-bed-deep': '1-Bedroom Deep Clean',
                '2-bed-deep': '2-Bedroom Deep Clean'
            };
            return names[serviceType] || serviceType;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            if (dateString === today) return 'Today';
            if (dateString === tomorrow) return 'Tomorrow';
            
            return date.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function showCleanerStatus(message, type) {
            const statusEl = document.getElementById('cleanerStatusMessage');
            statusEl.innerHTML = message;
            statusEl.className = `status-message status-${type} fade-in`;
            statusEl.style.display = 'block';
            
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>
